<map proto="1.5.0">
<name>Untitled - [1]</name>
<game>Touchdown</game>
<version>1.0.0</version>
<created>2025-12-07</created>
<modifybowprojectile pickup-filter="never"/>
<constants>
    <constant id="team-size">6</constant>
    <constant id="team-one-name">Blue</constant>
    <constant id="team-two-name">Red</constant>
    <constant id="team-one-color">blue</constant>
    <constant id="team-two-color">dark red</constant>
    <constant id="team-one-spawn">-23.5,35,-102.5</constant>
    <constant id="team-one-yaw">0</constant>
    <constant id="team-two-spawn">-23.5,35,13.5</constant>
    <constant id="team-two-yaw">180</constant>
    <constant id="flag-post">-23.5,27,-44.5</constant>
    <constant id="void-plane">20</constant>
    <constant id="main-kit">base-kit</constant>
    <constant id="armor-kit">custom-armor-kit</constant>
    <constant id="flag-carrier-armor-kit">custom-flag-carrier-armor-kit</constant>
    <constant id="show-tutorial">0</constant>
    <constant id="one-pass-default">0</constant> <!-- 0: one pass rule disabled; 1: enabled -->
    <!--custom constants for classes abilties-->
    <constant id="lvl-1-health">14</constant>
    <constant id="lvl-2-health">16</constant>
    <constant id="lvl-1-flag-health">10</constant>
    <constant id="lvl-2-flag-health">12</constant>
    <constant id="lvl-3-flag-health">14</constant>
    <constant id="lvl-1-speed">0.95</constant>
    <constant id="lvl-3-speed">1.15</constant>
    <constant id="superjump-ability-cooldown">8</constant> <!-- 8 seconds -->
    <constant id="tackle-ability-cooldown">80</constant> <!--80 ticks-->
</constants>
<include id="touchdown"/>
<authors>
    <author uuid="1aad55f7-2dea-4f22-85ca-ad9de3a78609"/> <!-- Technodono -->
</authors>
<kits>
    <kit id="base-kit" parent="apply-custom-healthbars">
        <item slot="8" material="golden apple"/>
        <game-mode>adventure</game-mode>
    </kit>
    <kit id="custom-armor-kit" force="true">
        <helmet unbreakable="true" team-color="true" locked="true" material="leather helmet"/>
        <leggings unbreakable="true" locked="true" material="chainmail leggings">
            <enchantment level="3">projectile_protection</enchantment>
        </leggings>
        <boots unbreakable="true" locked="true" material="iron boots"/>
    </kit>
    <kit id="custom-flag-carrier-armor-kit" force="true">
        <helmet material="air"/>
        <boots unbreakable="true" team-color="true" locked="true" material="leather boots"/>
    </kit>
    <kit id="apply-custom-healthbars" force="true" parents="lvl-1-health,lvl-2-health"/>
    <kit id="apply-custom-flag-healthbars"  parents="lvl-1-flag-health,lvl-2-flag-health,lvl-3-flag-health"/>
    
    <kit id="lvl-1-health" filter="has-assasin">
        <max-health>${lvl-1-health}</max-health>
    </kit>
    <kit id="lvl-2-health" filter="any(has-paramedic,has-jumper,has-blocker)">
        <max-health>${lvl-2-health}</max-health>
    </kit>

    <kit id="lvl-1-flag-health" filter="any(has-assasin)">
        <max-health>${lvl-1-flag-health}</max-health>
    </kit>
    <kit id="lvl-2-flag-health" filter="any(has-jumper,has-paramedic,has-blocker)">
        <max-health>${lvl-2-flag-health}</max-health>
    </kit>
    <kit id="lvl-3-flag-health" filter="any(has-ranger,has-attacker)">
        <max-health>${lvl-3-flag-health}</max-health>
    </kit>
    <kit id="custom-tutorial-kit">
            <book show-other="false">
                <title>`e`lHow to Play and Class List</title>
                <author>MewTwoKing and Technodono</author>
                <pages>
                    <page>
                        `2» `lTOUCHDOWN
                        `2» Overview`0

                        Each team has a
                        `6score box`0 located
                        on the other side of
                        the map.

                        Players must first
                        `6touch`0 the flag,
                        located at the center
                        of the map, and run to
                        the enemy team's side
                        to capture!
                    </page>
                    <page>
                        `2» `lTOUCHDOWN
                        `2» Passing (1/2)`0

                        The player with the
                        flag gets a `6snowball`0,
                        which can be thrown to
                        `6pass`0 the flag to the
                        player it hits.

                        If the snowball `6misses`0,
                        the flag will simply
                        respawn at the center.
                    </page>
                    <page>
                        `2» `lTOUCHDOWN
                        `2» Passing (2/2)`0

                        Caution: enemies can
                        `6intercept`0 the flag if
                        they are hit by the
                        snowball you throw!

                        Passing is a core part
                        of this game; use it to
                        make `6strategic`0 plays
                        and beat the enemy!
                    </page>
                    <page>
                        `2» `lCLASSES
                        `2» Attacker (1/6)`0
                        `8» Weapons (Stone Sword)`0

                        The core class of 
                        teamfight touchdown. 
                        With it's well rounded 
                        stats and simple kit it 
                        is a great introduction
                        to teamfight touchdown.
                    </page>
                    <page>
                        `2» `lCLASSES
                        `2» Assasin (2/6)`0
                        `8» Weapons (Sharpness Stone Sword)`0

                        Whenever an assasin scores a kill they get a short burst of speed and healing.

                    </page>
                    <page>
                        `2» `lCLASSES
                        `2» Ranger (3/6)`0
                        `8» Weapons (Stone Sword, Crossbow)`0

                        This class starts 
                        with six crossbows. 
                        Additional crossbows 
                        can be earned back 
                        through kills.
                    </page>
                    <page>
                        `2» `lCLASSES
                        `2» Paramedic (4/6)`0
                        `8» Weapons (Wooden Sword)`0

                        A support class that starts with two splash super healing potions.

                        

                    </page>
                    <page>
                        `2» `lCLASSES
                        `2» Jumper (5/6)`0
                        `8» Weapons (Wooden Sword)`0

                        By pressing space 
                        while in the air 
                        players can perform 
                        a high jump allowing 
                        for quick escapes or 
                        to duke out opponents.
                    </page>
                    <page>
                        `2» `lCLASSES
                        `2» Blocker (6/6)`0
                        `8» Weapons (Stone Sword)`0
                        
                        Spawns with a rechargeable ability that knocks back enemies when hit and instantly strips the flag.
                        
                        This class has knockback reduction.
                    </page>
                </pages>
            </book>
    </kit>
<give kit="custom-tutorial-kit" filter="all(observing)"/>
</kits>
<classes family="Classes">
    <class name="Attacker" default="true" description="`a`lMovement| ██`8░ `n`6`lCombat| ██`8░ `n`d`lHealth| ███ `n`b`l Ability: `7None " icon="gold sword">
        <kit parents="base-kit" id="attacker">
            <item slot="0" unbreakable="true" material="stone sword"/>
            <chestplate unbreakable="true" color="7f7f7f" locked="true" material="leather chestplate"/>
        </kit>
    </class>
        <class name="Assasin" description="`a`lMovement| ███ `n`6`lCombat| ███ `n`d`lHealth| █`8░░ `n`b`l Ability: `7Lifesteal" icon="blaze powder">
            <kit parents="base-kit" id="assasin">
                <item slot="0" unbreakable="true" material="stone sword" enchantment="sharpness:1"/>
                <chestplate unbreakable="true" color="FF0C7F" locked="true" material="leather chestplate"/>
                <walk-speed>${lvl-3-speed}</walk-speed>
            </kit>
        </class>
        <class name="Ranger" description="`a`lMovement| █`8░░ `n`6`lCombat| ███ `n`d`lHealth| ███ `n`b`l Ability: `7Crossbow Kit" icon="arrow">
            <kit parents="base-kit" id="ranger">
                <item slot="0" unbreakable="true" material="stone sword"/>
                <item slot="1" amount="6" projectile="arrow" name="`rCrossbow" lore="`r`7Right-click to fire!" material="firework charge"/>
                <chestplate unbreakable="true" color="7FFF0C" locked="true" material="leather chestplate"/>
                <walk-speed>${lvl-1-speed}</walk-speed>
            </kit>
        </class>
        <class name="Paramedic" description="`a`lMovement| ██`8░ `n`6`lCombat| █`8░░ `n`d`lHealth| ██`8░ `n`b`l Ability: `7Support Kit" icon="exp bottle">
            <kit parents="base-kit" id="paramedic">
                <item slot="0" unbreakable="true" material="wood sword"/>
                <chestplate unbreakable="true" color="0fffff" locked="true" material="leather chestplate"/>
                <item amount="2" material="potion" damage="16385" name="Super Heal">
                    <effect amplifier="1">instant_health</effect>
                    <effect duration="6s" amplifier="3">regeneration</effect>
                </item>
            </kit>
        </class>
        <class name="Jumper" description="`a`lMovement| ███ `n`6`lCombat| █`8░░ `n`d`lHealth| ██`8░ `n`b`l Ability: `7Superjump" icon="flint and steel">
            <kit parents="base-kit" id="jumper">
                <item slot="0" unbreakable="true" material="wood sword"/>
                <chestplate unbreakable="true" color="BF8CFF" locked="true" material="leather chestplate"/>
                <double-jump recharge-time="${superjump-ability-cooldown}" power="3.5"/>
            </kit>
        </class>
        <class name="Blocker" description="`a`lMovement| █`8░░ `n`6`lCombat| ██`8░ `n`d`lHealth| ██`8░ `n`b`l Ability: `7Tackle" icon="anvil">
            <kit parents="base-kit" id="blocker">
                <action id="reset-tackle-cooldown"/>
                <item slot="0" unbreakable="true" material="stone sword"/>
                <item slot="2" material="gold hoe" enchantment="knockback:2" prevent-sharing="true" name="`rAbility: `e`lTackle" lore="`7Instantly strips the flag carrier."/>
                <chestplate unbreakable="true" color="FFBF0C" locked="true" material="leather chestplate"/>
                <knockback-reduction>0.25</knockback-reduction>
                <walk-speed>${lvl-1-speed}</walk-speed>
            </kit>
        </class>
</classes>
<projectiles> 
    <projectile id="arrow" name="crossbow bolt" velocity="4" damage="7" throwable="true" cooldown="2.5s"/>
</projectiles>
<spawns>
    <default>
        <region yaw="90">
            <point>25.5,35,-43.5</point>
        </region>
    </default>
</spawns>
<variables>
    <player-location id="xp_bar_prog" component="exp progress"/>
    <variable id="tackle_ability_cd" default="0" scope="player"/>
</variables>
<filters>
    <class id="has-attacker">Attacker</class>
    <class id="has-assasin">Assasin</class>
    <class id="has-ranger">Ranger</class>
    <class id="has-paramedic">Paramedic</class>
    <class id="has-jumper">Jumper</class>
    <class id="has-blocker">Blocker</class>
    <after filter="not(has-flag)" duration="0.01" id="not-has-flag-0.01"/>
    <after filter="has-flag" duration="0.01" id="has-flag-0.01"/>
    <pulse id="tackle-progress" duration="0.05" period="0.1" filter="all(tackle_ability_cd=1..,not(during-buytime))"/>
    <all id="can-force-strip-flag">
        <victim>
            <variable var="player_state">${carry}</variable>
        </victim>
        <all id="attacker-is-using-ability">
            <cause>melee</cause>
            <attacker>
                <holding id="holding-gold-hoe" ignore-metadata="true" ignore-name="true" ignore-enchantments="true">
                    <item material="gold hoe"/>
                </holding>
            </attacker>
        </all>
    </all>
    <carrying id="has-gold-hoe">
        <item material="gold hoe" enchantment="knockback:2" prevent-sharing="true" name="`rAbility: `e`lTackle" lore="`7Instantly strips the flag carrier."/>
    </carrying>
    <carrying id="has-stone-hoe" ignore-metadata="true" ignore-name="true" ignore-enchantments="true">
        <item material="stone hoe" prevent-sharing="true" name="`7Ability: `8`lTackle" lore="`7Instantly strips the flag carrier."/>
    </carrying>
</filters>
<actions>
    <trigger filter="not-has-flag-0.01" action="apply-custom-healthbars" scope="player"/>
    <trigger filter="has-flag-0.01" action="apply-custom-flag-healthbars" scope="player"/>
    <action id="use-tackle-ability" scope="player" filter="attacker-is-using-ability">
        <action filter="can-force-strip-flag">
            <action id="flag-steal-event"/>
        </action>
        <replace-item>
            <find material="gold hoe" enchantment="knockback:2" prevent-sharing="true" name="`rAbility: `e`lTackle" lore="`7Instantly strips the flag carrier."/>
            <replace material="stone hoe" prevent-sharing="true" name="`7Ability: `8`lTackle" lore="`7Instantly strips the flag carrier."/>
        </replace-item>
        <set var="tackle_ability_cd" value="${tackle-ability-cooldown}"/>
        <set var="xp_bar_prog" value="0"/>
    </action>
    <trigger filter="tackle-progress" scope="player">
        <action>
            <set var="tackle_ability_cd" value="tackle_ability_cd-1"/>
            <set var="xp_bar_prog" value="min(0.99, 1 - (tackle_ability_cd/${tackle-ability-cooldown}))" />
            <action filter="tackle_ability_cd=0">
                <replace-item>
                    <find material="stone hoe" prevent-sharing="true" name="`7Ability: `8`lTackle" lore="`7Instantly strips the flag carrier."/>
                    <replace material="gold hoe" enchantment="knockback:2" prevent-sharing="true" name="`rAbility: `e`lTackle" lore="`7Instantly strips the flag carrier."/>
                </replace-item>
            </action>
        </action>
    </trigger>
    <trigger filter="during-buytime" action="reset-tackle-cooldown" scope="player"/>
    <action id="reset-tackle-cooldown"  scope="player">
        <set var="tackle_ability_cd" value="0"/>
        <set var="xp_bar_prog" value="1"/>
        <replace-item>
            <find material="stone hoe" prevent-sharing="true" name="`7Ability: `8`lTackle" lore="`7Instantly strips the flag carrier."/>
            <replace material="gold hoe" enchantment="knockback:2" prevent-sharing="true" name="`rAbility: `e`lTackle" lore="`7Instantly strips the flag carrier."/>
        </replace-item>
    </action>
    <action id="receive-tackle-ability" scope="player" filter="can-force-strip-flag">
        <set var="player_state" value="${initial}"/>
        <set var="flag_carrier" value="0"/>
    </action>
    <trigger filter="all(not(has-gold-hoe),not(has-stone-hoe),not(during-buytime))" action="give-new-tackle-ability" scope="player"/>
    <action id="give-new-tackle-ability" scope="player" filter="all(has-blocker,alive)">
        <action filter="tackle_ability_cd=1..">
            <kit>
                <item material="stone hoe" prevent-sharing="true" name="`7Ability: `8`lTackle" lore="`7Instantly strips the flag carrier."/>
            </kit>
        </action>
        <action filter="tackle_ability_cd=0">
            <kit>
                <item material="gold hoe" enchantment="knockback:2" prevent-sharing="true" name="`rAbility: `e`lTackle" lore="`7Instantly strips the flag carrier."/>
            </kit>
        </action>
    </action>
    <action id="custom-attacker-actions" scope="player">
        <action id="reset-after-throw"/>
        <action id="use-tackle-ability"/>
    </action>
    <action id="custom-victim-actions" scope="player">
        <action id="damage-receive-event"/>
        <action id="receive-tackle-ability"/>
    </action>
</actions>
<regions>
    <union id="barriers">
        <cuboid min="1,24,-100" max="2,28,11"/>
        <cuboid min="-49,24,-100" max="-48,28,11"/>
    </union>
    <cuboid id="playing-field" min="-48,23,-100" max="1,30,11"/>
    <cuboid id="team-one-portal" min="-48,24,-100" max="1,28,-89"/> <!-- where team two scores -->
    <cuboid id="team-two-portal" min="-48,24,0" max="1,28,11"/> <!-- where team one scores -->
    <cuboid id="flag-indicator-upper" min="-25,35,-46" max="-22,40,-43"/>
    <cuboid id="flag-indicator-lower" min="-25,32,-46" max="-22,34,-43"/>
    <apply block-physics="never"/>
</regions>
<compass show-distance="true">
    <player filter="has-flag" show-player="true" name="Flag Carrier"/>
</compass>
<world>
    <timeset>6000</timeset>
</world>
<damage attacker-action="custom-attacker-actions" victim-action="custom-victim-actions"/>
<damage>
    <deny>
        <all>
            <not>
                <damager>
                    <entity>snowball</entity>
                </damager>
            </not>
            <filter id="ally-damage"/>
        </all>
    </deny>
</damage>
<kill-rewards>
    <kill-reward filter="has-assasin">
        <kit>
           <effect duration="2" amplifier="1">speed</effect>
           <effect duration="3" amplifier="3">regeneration</effect>
        </kit>
    </kill-reward>
    <kill-reward filter="has-ranger">
        <item amount="3" projectile="arrow" name="`rCrossbow" lore="`r`7Right-click to fire!" material="firework charge"/>
    </kill-reward>
</kill-rewards>
<itemremove>
    <item>wood sword</item>
    <item>stone sword</item>
    <item>gold hoe</item>
    <item>stone hoe</item>
    <item>bow</item>
    <item>firework charge</item>
</itemremove>
<toolrepair>
    <tool>compass</tool>
</toolrepair>
<respawn delay="${respawn-timer}" auto="false"/>
</map>
